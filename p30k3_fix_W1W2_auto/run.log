
===== Auto-Constraint Run started: 2025-08-21 15:55:10 =====

--- STEP 1: Running Exploratory MCMC (1 chain, no constraints) ---
Running chain 1 of 1 ...
Exploratory run completed.
Calculating correlation matrix for 'Posterior Correlation (BEFORE Constraints)'...
'Posterior Correlation (BEFORE Constraints)' heatmap generated.

--- STEP 2: Identifying Anchors and Constraint Values ---
--- Identifying Anchor Loadings ---
Anchor for Factor 1: W[8, 1] (Value: -0.6689)
Anchor for Factor 2: W[4, 2] (Value: 0.8276)
Anchor for Factor 3: W[12, 3] (Value: -0.6899)
------------------------------------
Error in anchor_indices[[k]] : 
  attempt to select less than one element in get1index <real>
Execution halted

===== Auto-Constraint Run started: 2025-08-21 15:57:07 =====

--- STEP 1: Running Exploratory MCMC (1 chain, no constraints) ---
Running chain 1 of 1 ...
Exploratory run completed.
Calculating correlation matrix for 'Posterior Correlation (BEFORE Constraints)'...
'Posterior Correlation (BEFORE Constraints)' heatmap generated.

--- STEP 2: Identifying Anchors and Constraint Values ---
--- Identifying Anchor Loadings ---
Anchor for Factor 1: W[8, 1] (Value: -0.6689)
Anchor for Factor 2: W[4, 2] (Value: 0.8276)
Anchor for Factor 3: W[12, 3] (Value: -0.6899)
------------------------------------
Constraint for final run: W[8, 1] will be fixed to -0.6689
Constraint for final run: W[4, 2] will be fixed to 0.8276
Note: Factor 3 will be left unconstrained.

--- STEP 3: Running Final MCMC with 2 constraints ---
Running chain 1 of 3 ...
Running chain 2 of 3 ...
Running chain 3 of 3 ...
=== CONVERGENCE ASSESSMENT ===

1. MODEL-WIDE PARAMETERS:
   Noise Variance (sigma2)        R-hat: 2.0000
   Global Shrinkage (lambda2)     R-hat: 2.0000

2. GROUP-SPECIFIC SCALES (tau_g):
   Group Scale (tau_1)            R-hat: 2.0000
   Group Scale (tau_2)            R-hat: 2.0000
   Group Scale (tau_3)            R-hat: 2.0000
   Group Scale (tau_4)            R-hat: 2.0000
   Group Scale (tau_5)            R-hat: 2.0000

3. FACTOR LOADINGS (W):
   Loading W[1,1]                 R-hat: 1.5039
   Loading W[15,1]                R-hat: 1.1758
   Loading W[30,1]                R-hat: 1.0049
   Loading W[8,3]                 R-hat: 1.1774
   Loading W[30,3]                R-hat: 1.0040

4. LATENT FACTORS (Z):
   Factor Z[1,1]                  R-hat: 1.3360
   Factor Z[100,1]                R-hat: 1.1265
   Factor Z[200,1]                R-hat: 1.3104
   Factor Z[50,3]                 R-hat: 1.1018
   Factor Z[200,3]                R-hat: 1.4633

=== CONVERGENCE SUMMARY ===
   Total parameters tested: 17
   Max R-hat: 2.0000
   Convergence (< 1.1): 11.8%

RECOMMENDATION: POOR. Convergence issues detected. Increase iterations or check model.
Final constrained model MCMC run completed.
Calculating correlation matrix for 'Posterior Correlation (AFTER Constraints)'...
'Posterior Correlation (AFTER Constraints)' heatmap generated.

--- STEP 4: Generating Final Diagnostic Report ---
=== CONVERGENCE ASSESSMENT ===

1. MODEL-WIDE PARAMETERS:
   Noise Variance (sigma2)        R-hat: 2.0000
   Global Shrinkage (lambda2)     R-hat: 2.0000

2. GROUP-SPECIFIC SCALES (tau_g):
   Group Scale (tau_1)            R-hat: 2.0000
   Group Scale (tau_2)            R-hat: 2.0000
   Group Scale (tau_3)            R-hat: 2.0000
   Group Scale (tau_4)            R-hat: 2.0000
   Group Scale (tau_5)            R-hat: 2.0000

3. FACTOR LOADINGS (W):
   Loading W[1,1]                 R-hat: 1.5039
   Loading W[15,1]                R-hat: 1.1758
   Loading W[30,1]                R-hat: 1.0049
   Loading W[8,3]                 R-hat: 1.1774
   Loading W[30,3]                R-hat: 1.0040

4. LATENT FACTORS (Z):
   Factor Z[1,1]                  R-hat: 1.3360
   Factor Z[100,1]                R-hat: 1.1265
   Factor Z[200,1]                R-hat: 1.3104
   Factor Z[50,3]                 R-hat: 1.1018
   Factor Z[200,3]                R-hat: 1.4633

=== CONVERGENCE SUMMARY ===
   Total parameters tested: 17
   Max R-hat: 2.0000
   Convergence (< 1.1): 11.8%

RECOMMENDATION: POOR. Convergence issues detected. Increase iterations or check model.
=== CREATING W MATRIX HEATMAP COMPARISON ===

1. Normalization Tests:
   Frobenius norm (true): 3.3017 
   Frobenius norm (estimated): 2.7382 
   Norm ratio (est/true): 0.8293 
   Column norms (true): 1.9123, 1.8878, 1.9186 
   Column norms (estimated): 0.7900, 1.8515, 1.8562 
   Interpretation (norm ratio): good recovery (minor scale drift) 

2. Creating Heatmaps...
  Saved W comparison plots to: p30k3_final_auto_constraints 
Full diagnostic report generated.
All processes completed successfully.
