
===== Run started: 2025-08-18 13:02:56 =====
Running chain 1 of 3 ...
Running chain 2 of 3 ...
Running chain 3 of 3 ...
Error in apply(W_chains, c(1, 3, 4), mean) : 
  'MARGIN' does not match dim(X)
Calls: mcmc_bpca_group_lasso -> align_factor_chains -> apply
Execution halted

===== Run started: 2025-08-18 13:11:31 =====
Running chain 1 of 3 ...
Running chain 2 of 3 ...
Running chain 3 of 3 ...
=== CONVERGENCE ASSESSMENT ===

1. MODEL-WIDE PARAMETERS:
   Noise Variance (sigma2)        R-hat: 2.0000
   Global Shrinkage (lambda2)     R-hat: 2.0000

2. GROUP-SPECIFIC SCALES (tau_g):
   Group Scale (tau_1)            R-hat: 2.0000
   Group Scale (tau_2)            R-hat: 2.0000
   Group Scale (tau_3)            R-hat: 2.0000
   Group Scale (tau_4)            R-hat: 2.0000
   Group Scale (tau_5)            R-hat: 2.0000

3. FACTOR LOADINGS (W):
   Loading W[1,1]                 R-hat: 1.0055
   Loading W[15,1]                R-hat: 1.0003
   Loading W[30,1]                R-hat: 1.0001
   Loading W[8,1]                 R-hat: 1.0002
   Loading W[30,1]                R-hat: 1.0001

4. LATENT FACTORS (Z):
   Factor Z[1,1]                  R-hat: 1.0019
   Factor Z[100,1]                R-hat: 1.0059
   Factor Z[200,1]                R-hat: 1.0044
   Factor Z[50,1]                 R-hat: 1.0039
   Factor Z[200,1]                R-hat: 1.0044

=== CONVERGENCE SUMMARY ===
   Total parameters tested: 17
   Max R-hat: 2.0000
   Convergence (< 1.1): 58.8%

RECOMMENDATION: POOR. Convergence issues detected. Increase iterations or check model.
=== CONVERGENCE ASSESSMENT ===

1. MODEL-WIDE PARAMETERS:
   Noise Variance (sigma2)        R-hat: 2.0000
   Global Shrinkage (lambda2)     R-hat: 2.0000

2. GROUP-SPECIFIC SCALES (tau_g):
   Group Scale (tau_1)            R-hat: 2.0000
   Group Scale (tau_2)            R-hat: 2.0000
   Group Scale (tau_3)            R-hat: 2.0000
   Group Scale (tau_4)            R-hat: 2.0000
   Group Scale (tau_5)            R-hat: 2.0000

3. FACTOR LOADINGS (W):
   Loading W[1,1]                 R-hat: 1.0055
   Loading W[15,1]                R-hat: 1.0003
   Loading W[30,1]                R-hat: 1.0001
   Loading W[8,1]                 R-hat: 1.0002
   Loading W[30,1]                R-hat: 1.0001

4. LATENT FACTORS (Z):
   Factor Z[1,1]                  R-hat: 1.0019
   Factor Z[100,1]                R-hat: 1.0059
   Factor Z[200,1]                R-hat: 1.0044
   Factor Z[50,1]                 R-hat: 1.0039
   Factor Z[200,1]                R-hat: 1.0044

=== CONVERGENCE SUMMARY ===
   Total parameters tested: 17
   Max R-hat: 2.0000
   Convergence (< 1.1): 58.8%

RECOMMENDATION: POOR. Convergence issues detected. Increase iterations or check model.
=== CREATING W MATRIX HEATMAP COMPARISON ===

1. Normalization Tests:
   Frobenius norm (true): 1.9123 
   Frobenius norm (estimated): 2.0123 
   Norm ratio (est/true): 1.0523 
   Column norms (true): 1.9123 
   Column norms (estimated): 2.0123 
   Interpretation (norm ratio): excellent recovery (scale matched) 

2. Creating Heatmaps...
  Saved W comparison plots to: p30k1 
2025-08-18 13:13:24 | max_rhat=2.000, prop_converged=0.588, corr=0.998, rmse=0.0268, norm_ratio=1.052, max_abs_diff=0.067
